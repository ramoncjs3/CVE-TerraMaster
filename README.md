# TerraMaster   

# Vulnerability Description

Description: TerraMaster TOS V3.X.X-V4.1.X Password recovery function is defective.An attacker can receive a verification code by forging a mailbox, and can reset the administrator user password.  

Vulnerability Name: TerraMaster TOS V3.X.X-V4.1.X Password recovery function is defective  

Product Homepage: https://www.terra-master.com  

Version: V3.X.X-V4.1.X  



# Vulnerability details

1.Password recovery URL: http://xx.xx.xx.xx:8181/wizard/getpass.php

![image-1](https://github.com/ramoncjs3/CVE-TerraMaster/blob/master/photos/01.jpg)

2.return in the correct email address after filling in the username.

![image-2](https://github.com/ramoncjs3/CVE-TerraMaster/blob/master/photos/02.jpg)

![image-3](https://github.com/ramoncjs3/CVE-TerraMaster/blob/master/photos/04.jpg)

![image-4](https://github.com/ramoncjs3/CVE-TerraMaster/blob/master/photos/03.jpg)

3.Open the packet capture and click Send Verification Code to change the admin's mailbox that correctly receives the verification code to a fake mailbox.

![image-5](https://github.com/ramoncjs3/CVE-TerraMaster/blob/master/photos/05.jpg)

![image-6](https://github.com/ramoncjs3/CVE-TerraMaster/blob/master/photos/06.jpg)

4.Successfully received the correct verification code。

![image-7](https://github.com/ramoncjs3/CVE-TerraMaster/blob/master/photos/07.jpg)

5.Submit a new password and submit a request for modification.

![image-8](https://github.com/ramoncjs3/CVE-TerraMaster/blob/master/photos/08.jpg)

6.Password modification request submitted successfully。

![image-9](https://github.com/ramoncjs3/CVE-TerraMaster/blob/master/photos/09.jpg)

7.Successful login system.

![image-10](https://github.com/ramoncjs3/CVE-TerraMaster/blob/master/photos/10.jpg)

# Examples

## 1. Fingerprint information
Default Port: 8080

X-Powered-By: TerraMaster

Server: TOS/1.X.X

At least 10,000 devices worldwide are affected.


## 2. some examples
http://216.246.156.70:8181/wizard/getpass.php

http://73.53.49.147:8181/wizard/getpass.php

http://221.214.197.123:8181/wizard/getpass.php

http://81.159.86.207:8181/wizard/getpass.php

http://24.47.71.239:8181/wizard/getpass.php

http://174.52.100.60:8181/wizard/getpass.php

http://123.134.153.13:8181/wizard/getpass.php

http://68.33.58.49:8181/wizard/getpass.php

http://121.131.218.129:8181/wizard/getpass.php

http://220.97.117.87:8181/wizard/getpass.php



