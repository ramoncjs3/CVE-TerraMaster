# Description
Description: TerraMaster TOS V3.X.X-V4.1.X Password recovery function is defective.An attacker can receive a verification code by forging a mailbox, and can reset the administrator user password.  

Vulnerability Name: TerraMaster TOS V3.X.X-V4.1.X Password recovery function is defective  

Product Homepage: https://www.terra-master.com  

Version: V3.X.X-V4.1.X  



# Vulnerability details

Password recovery URL: http://xx.xx.xx.xx:8181/wizard/getpass.php
# Vulnerability Description

Description: TerraMaster TOS V3.X.X-V4.1.X Password recovery function is defective.An attacker can receive a verification code by forging a mailbox, and can reset the administrator user password.  

Vulnerability Name: TerraMaster TOS V3.X.X-V4.1.X Password recovery function is defective  

Product Homepage: https://www.terra-master.com  

Version: V3.X.X-V4.1.X  



# Vulnerability details

Password recovery URL: http://xx.xx.xx.xx:8181/wizard/getpass.php

![image-20191106230837986](/Users/ramoncjs/Library/Application Support/typora-user-images/image-20191106230837986.png)

return in the correct email address after filling in the username.

![image-20191106231506430](/Users/ramoncjs/Library/Application Support/typora-user-images/image-20191106231506430.png)

![image-20191106231519307](/Users/ramoncjs/Library/Application Support/typora-user-images/image-20191106231519307.png)

![image-20191106231528027](/Users/ramoncjs/Library/Application Support/typora-user-images/image-20191106231528027.png)

Open the packet capture and click Send Verification Code to change the administrator's mailbox that correctly receives the verification code to a fake mailbox.

![image-20191106231641373](/Users/ramoncjs/Library/Application Support/typora-user-images/image-20191106231641373.png)

![image-20191106231649386](/Users/ramoncjs/Library/Application Support/typora-user-images/image-20191106231649386.png)

Successfully received the correct verification code。

![image-20191106231744626](/Users/ramoncjs/Library/Application Support/typora-user-images/image-20191106231744626.png)

Submit a new password and submit a request for modification.

![image-20191106231847269](/Users/ramoncjs/Library/Application Support/typora-user-images/image-20191106231847269.png)

Password modification request submitted successfully。

![image-20191106231945018](/Users/ramoncjs/Library/Application Support/typora-user-images/image-20191106231945018.png)



Successful login system.

![image-20191106231954368](/Users/ramoncjs/Library/Application Support/typora-user-images/image-20191106231954368.png)

