# Vulnerability Description

Description: TerraMaster TOS V3.X.X-V4.1.X Password recovery function is defective.An attacker can receive a verification code by forging a mailbox, and can reset the administrator user password.  

Vulnerability Name: TerraMaster TOS V3.X.X-V4.1.X Password recovery function is defective  

Product Homepage: https://www.terra-master.com  

Version: V3.X.X-V4.1.X  



# Vulnerability details

1.Password recovery URL: http://xx.xx.xx.xx:8181/wizard/getpass.php

![image-1](https://github.com/ramoncjs3/CVE-Test/blob/master/photos/01.jpg)

2.return in the correct email address after filling in the username.

![image-2](https://github.com/ramoncjs3/CVE-Test/blob/master/photos/02.jpg)

![image-3](https://github.com/ramoncjs3/CVE-Test/blob/master/photos/04.jpg)

![image-4](https://github.com/ramoncjs3/CVE-Test/blob/master/photos/03.jpg)

3.Open the packet capture and click Send Verification Code to change the admin's mailbox that correctly receives the verification code to a fake mailbox.

![image-5](https://github.com/ramoncjs3/CVE-Test/blob/master/photos/05.jpg)

![image-6](https://github.com/ramoncjs3/CVE-Test/blob/master/photos/06.jpg)

4.Successfully received the correct verification code。

![image-20191106231744626](https://github.com/ramoncjs3/CVE-Test/blob/master/photos/07.jpg)

5.Submit a new password and submit a request for modification.

![image-20191106231847269](https://github.com/ramoncjs3/CVE-Test/blob/master/photos/08.jpg)

6.Password modification request submitted successfully。

![image-20191106231945018](https://github.com/ramoncjs3/CVE-Test/blob/master/photos/09.jpg)

7.Successful login system.

![image-20191106231954368](https://github.com/ramoncjs3/CVE-Test/blob/master/photos/10.jpg)

